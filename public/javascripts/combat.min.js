/*! Personal_Project 2015-06-02 */
myApp.controller("CombatController",["$scope","$http","$location","SelectedPlayer",function(a,b,c,d){a.mansion=[],a.easy=[],a.medium=[],a.hard=[],a.playerInventory=[],a.items=[],console.log(d),a.buildMansion=function(b){return a.mansion=b.splice(0,3)},a.getItems=function(){b.get("/items").then(function(b){console.log(b.data),a.items=b.data,a.buildInventory(b.data)})},a.buildInventory=function(c){for(var d,e=0;e<c.length;e++)if("Ammo x10"===c[e].name){d=c[e]._id;for(var f=0;7>f;f++)b.get("/items/"+d).then(function(b){a.playerInventory.push(b.data),console.log(a.playerInventory)})}else if("Combat Knife"===c[e].name){d=c[e]._id;for(var f=0;2>f;f++)b.get("/items/"+d).then(function(b){a.playerInventory.push(b.data),console.log(a.playerInventory)})}else"Handgun"===c[e].name&&(d=c[e]._id,b.get("/items/"+d).then(function(b){a.playerInventory.push(b.data),console.log(a.playerInventory)}))},a.battlefield=function(){b.get("/monsters").then(function(b){console.log(b.data),a.buildMansion(b.data)}),b.get("/users/combat/"+d.playerId).then(function(b){console.log(b.data),a.player=b.data.characters[0],console.log(a.player)})},a.go=function(a){c.path(a)},a.fight=function(){if(a.outcome=a.mansion[0].monsterHealth-a.player.playerAttack,a.mansion[0].monsterHealth=a.outcome,a.outcome<=0)a.mansion.shift(),0===a.mansion.length&&a.go("/win");else{console.log(a.player.playerHealth),console.log(a.mansion[0].monsterAttack);var b=a.player.playerHealth-a.mansion[0].monsterAttack;console.log(b),a.player.playerHealth=b}a.player.playerHealth<=0&&a.go("/lose")},a.battlefield(),a.getItems()}]);